angular.module("commonServices",[]),angular.module("common",["ngResource","default","xml","hl7v2-edi","hl7v2","edi","soap","hit-util"]),angular.module("main",["common"]),angular.module("account",["common"]),angular.module("cf",["common"]),angular.module("doc",["common"]),angular.module("hit-tool-directives",[]),angular.module("hit-tool-services",["common"]),angular.module("documentation",[]),angular.module("upload",["common"]);var app=angular.module("hit-app",["ngRoute","ui.bootstrap","ngCookies","LocalStorageModule","ngResource","ngSanitize","ngIdle","ngAnimate","ui.bootstrap","ui-notification","angularBootstrapNavTree","QuickList","hit-util","format","default","hl7v2-edi","xml","hl7v2","edi","soap","cf","ngTreetable","blueimp.fileupload","hit-tool-directives","hit-tool-services","commonServices","smart-table","hit-profile-viewer","hit-validation-result","hit-vocab-search","hit-report-viewer","hit-testcase-details","hit-testcase-tree","hit-doc","hit-settings","doc","account","main","hit-manual-report-viewer","ociFixedHeader","upload","angularFileUpload"]),httpHeaders,loginMessage,spinner,mToHide=["usernameNotFound","emailNotFound","usernameFound","emailFound","loginSuccess","userAdded","uploadImageFailed"],msg={};app.config(["$routeProvider","$httpProvider","localStorageServiceProvider","KeepaliveProvider","IdleProvider","NotificationProvider",function(a,b,c,d,e,f){c.setPrefix("hit-app").setStorageType("sessionStorage"),a.when("/",{templateUrl:"views/home.html"}).when("/home",{templateUrl:"views/home.html"}).when("/doc",{templateUrl:"views/doc.html"}).when("/setting",{templateUrl:"views/setting.html"}).when("/about",{templateUrl:"views/about.html"}).when("/cf",{templateUrl:"views/cf/cf.html"}).when("/upload",{templateUrl:"views/upload/upload.html"}).when("/error",{templateUrl:"error.html"}).when("/transport-settings",{templateUrl:"views/transport-settings.html"}).when("/forgotten",{templateUrl:"views/account/forgotten.html",controller:"ForgottenCtrl"}).when("/registration",{templateUrl:"views/account/registration.html",controller:"RegistrationCtrl"}).when("/useraccount",{templateUrl:"views/account/userAccount.html"}).when("/glossary",{templateUrl:"views/glossary.html"}).when("/resetPassword",{templateUrl:"views/account/registerResetPassword.html",controller:"RegisterResetPasswordCtrl",resolve:{isFirstSetup:function(){return!1}}}).when("/registrationSubmitted",{templateUrl:"views/account/registrationSubmitted.html"}).otherwise({redirectTo:"/"}),b.interceptors.push("interceptor1"),b.interceptors.push("interceptor2"),b.interceptors.push("interceptor3"),b.interceptors.push("interceptor4"),e.idle(7200),e.timeout(30),d.interval(10),f.setOptions({delay:3e4,maxCount:1}),httpHeaders=b.defaults.headers}]),app.factory("interceptor1",["$q","$rootScope","$location","StorageService","$window",function(a,b,c,d,e){var f=function(a){console.log("interceptor1"),440===a.status?(a.data="Session timeout",b.openSessionExpiredDlg()):498===a.status&&(a.data="Invalid Application State",b.openVersionChangeDlg())};return{responseError:function(b){return f(b),a.reject(b)}}}]),app.factory("interceptor2",["$q","$rootScope","$location","StorageService","$window",function(a,b,c,d,e){return{response:function(b){return b||a.when(b)},responseError:function(c){if(401===c.status&&"api/accounts/cuser"!==c.config.url){if("api/accounts/login"!==c.config.url){var d=a.defer(),e={config:c.config,deferred:d};b.requests401.push(e)}return b.$broadcast("event:loginRequired"),a.when(c)}return a.reject(c)}}}]),app.factory("interceptor3",["$q","$rootScope","$location","StorageService","$window",function(a,b,c,d,e){return{response:function(b){return spinner=!1,b||a.when(b)},responseError:function(b){return spinner=!1,a.reject(b)}}}]),app.factory("interceptor4",["$q","$rootScope","$location","StorageService","$window",function(a,b,c,d,e){var f=function(a){if(console.log("interceptor4"),a.data&&a.data.text&&a.data.type)if(401===a.status)loginMessage={text:a.data.text,type:a.data.type,skip:a.data.skip,show:!0,manualHandle:a.data.manualHandle};else if(503===a.status)msg={text:"server.down",type:"danger",show:!0,manualHandle:!0};else{console.log(a.status),msg={text:a.data.text,type:a.data.type,skip:a.data.skip,show:!0,manualHandle:a.data.manualHandle};for(var b=!1,c=0;c<mToHide.length&&!b;)msg.text===mToHide[c]&&(b=!0),c++;b===!0&&(msg.show=!1)}};return{response:function(b){return f(b),b||a.when(b)},responseError:function(b){return f(b),a.reject(b)}}}]),app.run(["Session","$rootScope","$location","$modal","TestingSettings","AppInfo","$q","$sce","$templateCache","$compile","StorageService","$window","$route","$timeout","$http","User","Idle","Transport","IdleService","userInfoService","base64","Notification",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){function w(){return l.location.pathname.substring(0,l.location.pathname.indexOf("/",2))}b.appInfo={},b.stackPosition=0,b.transportSupported=!1,b.scrollbarWidth=null,b.vcModalInstance=null,b.sessionExpiredModalInstance=null,b.errorModalInstanceInstance=null;var x=function(a){t.setCurrentUser(a),p.initUser(a),r.init()};f.get().then(function(a){b.appInfo=a,b.apiLink=l.location.protocol+"//"+l.location.host+w()+b.appInfo.apiDocsPath,httpHeaders.common.rsbVersion=a.rsbVersion;var c=k.get(k.APP_STATE_TOKEN);null!=c&&c!==a.rsbVersion&&b.openVersionChangeDlg(),k.set(k.APP_STATE_TOKEN,a.rsbVersion)},function(a){b.appInfo={},b.openCriticalErrorDlg("Sorry we could not communicate with the server. Please try again")}),b.$watch(function(){return c.path()},function(a,c){if(b.activePath===a){var d,e=l.history.state;d=!!(e&&e.position<=b.stackPosition),d?b.stackPosition--:b.stackPosition++}else m.current&&(l.history.replaceState({position:b.stackPosition},""),b.stackPosition++)}),b.isActive=function(a){return a===b.activePath},b.setActive=function(a){""===a||"/"===a?c.path("/home"):b.activePath=a},b.isSubActive=function(a){return a===b.subActivePath},b.setSubActive=function(a){b.subActivePath=a,k.set(k.ACTIVE_SUB_TAB_KEY,a)},b.msg=function(){return msg},b.loginMessage=function(){return loginMessage},b.showSpinner=function(){return spinner},b.createGuestIfNotExist=function(){console.log("creating guest user"),p.createGuestIfNotExist().then(function(a){x(a),console.log("guest user created")},function(a){b.openCriticalErrorDlg("ERROR: Sorry, Failed to initialize the session. Please refresh the page and try again.")})},b.requests401=[],b.$on("event:loginRequired",function(){b.showLoginDialog()}),b.$on("event:loginConfirmed",function(){x(t.getCurrentUser());var a,c=b.requests401,d=function(a){o(a.config).then(function(b){a.deferred.resolve(b)})};for(a=0;a<c.length;a+=1)d(c[a]);b.requests401=[]}),b.$on("event:loginRequest",function(a,c,d){httpHeaders.common.Accept="application/json",httpHeaders.common.Authorization="Basic "+u.encode(c+":"+d),o.get("api/accounts/login").success(function(){httpHeaders.common.Authorization=null,o.get("api/accounts/cuser").then(function(a){if(a.data&&null!=a.data){var c=angular.fromJson(a.data);x(c),b.$broadcast("event:loginConfirmed")}else t.setCurrentUser(null)},function(){t.setCurrentUser(null)})})}),b.$on("event:logoutRequest",function(){httpHeaders.common.Authorization=null,t.setCurrentUser(null),o.get("j_spring_security_logout").then(function(a){b.createGuestIfNotExist()})}),b.$on("event:loginCancel",function(){httpHeaders.common.Authorization=null}),b.$on("$routeChangeStart",function(a,b){msg&&"false"===msg.manualHandle&&(msg.show=!1)}),b.$watch(function(){return b.msg().text},function(a){b.showNotification(b.msg())}),b.$watch("language()",function(a){b.showNotification(b.msg())}),b.loadFromCookie=function(){t.hasCookieInfo()===!0&&(t.loadFromCookie(),httpHeaders.common.Authorization=t.getHthd())},b.showNotification=function(a){if(void 0!=a&&a.show&&null!=a.text){var c=angular.copy(a),d=$.i18n.prop(c.text),e=c.type;"danger"===e?v.error({message:d,templateUrl:"NotificationErrorTemplate.html",scope:b,delay:1e4}):"warning"===e?v.warning({message:d,templateUrl:"NotificationWarningTemplate.html",scope:b,delay:5e3}):"success"===e&&v.success({message:d,templateUrl:"NotificationSuccessTemplate.html",scope:b,delay:5e3}),a.text=null,a.type=null,a.show=!1}},b.getScrollbarWidth=function(){if(0==b.scrollbarWidth){var a=document.createElement("div");a.style.visibility="hidden",a.style.width="100px",a.style.msOverflowStyle="scrollbar",document.body.appendChild(a);var c=a.offsetWidth;a.style.overflow="scroll";var d=document.createElement("div");d.style.width="100%",a.appendChild(d);var e=d.offsetWidth;a.parentNode.removeChild(a),b.scrollbarWidth=c-e}return b.scrollbarWidth},t.loadFromServer().then(function(a){console.log("currentUser="+angular.toJson(a)),null!==a&&null!=a.id&&void 0!=a.id?x(a):b.createGuestIfNotExist()},function(a){b.createGuestIfNotExist()}),b.getAppInfo=function(){return b.appInfo}}]),angular.module("ui.bootstrap.carousel",["ui.bootstrap.transition"]).controller("CarouselController",["$scope","$timeout","$transition","$q",function(a,b,c,d){}]).directive("carousel",[function(){return{}}]),angular.module("hit-tool-services").factory("TabSettings",["$rootScope",function(a){return{"new":function(a){return{key:a,activeTab:0,getActiveTab:function(){return this.activeTab},setActiveTab:function(a){this.activeTab=a,this.save()},save:function(){sessionStorage.setItem(this.key,this.activeTab)},restore:function(){this.activeTab=null!=sessionStorage.getItem(this.key)&&""!=sessionStorage.getItem(this.key)?parseInt(sessionStorage.getItem(this.key)):0}}}}}]),app.controller("ErrorDetailsCtrl",["$scope","$modalInstance","error",function(a,b,c){a.error=c,a.ok=function(){b.close(a.error)},a.cancel=function(){b.dismiss("cancel")}}]),app.directive("stRatio",function(){return{link:function(a,b,c){var d=+c.stRatio;b.css("width",d+"%")}}}),app.controller("TableFoundCtrl",["$scope","$modalInstance","table",function(a,b,c){a.table=c,a.tmpTableElements=[].concat(null!=c?c.valueSetElements:[]),a.cancel=function(){b.dismiss("cancel")}}]),app.controller("ValidationResultInfoCtrl",["$scope","$modalInstance",function(a,b){a.close=function(){b.dismiss("cancel")}}]),app.filter("capitalize",function(){return function(a){return a?a.charAt(0).toUpperCase()+a.substr(1).toLowerCase():""}}),app.controller("ErrorCtrl",["$scope","$modalInstance","StorageService","$window",function(a,b,c,d){a.refresh=function(){b.close(d.location.reload())}}]),app.controller("FailureCtrl",["$scope","$modalInstance","StorageService","$window","error",function(a,b,c,d,e){a.error=e,a.close=function(){b.close()}}]),app.service("base64",function(){var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";this.encode=function(b){for(var c,d,e,f,g,h="",i="",j="",k=0;k<b.length;)c=b.charCodeAt(k++),d=b.charCodeAt(k++),i=b.charCodeAt(k++),e=c>>2,f=(3&c)<<4|d>>4,g=(15&d)<<2|i>>6,j=63&i,isNaN(d)?g=j=64:isNaN(i)&&(j=64),h=h+a.charAt(e)+a.charAt(f)+a.charAt(g)+a.charAt(j),c=d=i="",e=f=g=j="";return h},this.decode=function(b){var c,d,e,f,g,h="",i="",j="",k=0;for(b=b.replace(/[^A-Za-z0-9\+\/\=]/g,"");k<b.length;)e=a.indexOf(b.charAt(k++)),f=a.indexOf(b.charAt(k++)),g=a.indexOf(b.charAt(k++)),j=a.indexOf(b.charAt(k++)),c=e<<2|f>>4,d=(15&f)<<4|g>>2,i=(3&g)<<6|j,h+=String.fromCharCode(c),64!==g&&(h+=String.fromCharCode(d)),64!==j&&(h+=String.fromCharCode(i)),c=d=i="",e=f=g=j=""}}),app.factory("i18n",function(){var a,b=function(b){$.i18n.properties({name:"messages",path:"lang/",mode:"map",language:b,callback:function(){a=b}})};return b("en"),{setLanguage:b}}),app.factory("Resource",["$resource",function(a){return function(b,c,d){var e={update:{method:"put",isArray:!1},create:{method:"post"}};d=angular.extend(e,d);var f=a(b,c,d);return f.prototype.$save=function(a,b){return this.id?this.$update(a,b):this.$create(a,b)},f}}]),angular.module("commonServices").factory("StorageService",["$rootScope","localStorageService",function(a,b){var c={CF_EDITOR_CONTENT_KEY:"CF_EDITOR_CONTENT",CF_LOADED_TESTCASE_ID_KEY:"CF_LOADED_TESTCASE_ID",CF_LOADED_TESTCASE_TYPE_KEY:"CF_LOADED_TESTCASE_TYPE",CB_EDITOR_CONTENT_KEY:"CB_EDITOR_CONTENT",CB_SELECTED_TESTCASE_ID_KEY:"CB_SELECTED_TESTCASE_ID",CB_SELECTED_TESTCASE_TYPE_KEY:"CB_SELECTED_TESTCASE_TYPE",CB_LOADED_TESTCASE_ID_KEY:"CB_LOADED_TESTCASE_ID",CB_LOADED_TESTCASE_TYPE_KEY:"CB_LOADED_TESTCASE_TYPE",CB_LOADED_TESTSTEP_TYPE_KEY:"CB_LOADED_TESTSTEP_TYPE_KEY",CB_LOADED_TESTSTEP_ID_KEY:"CB_LOADED_TESTSTEP_ID",TRANSPORT_CONFIG_KEY:"TRANSPORT_CONFIG_KEY",ACTIVE_SUB_TAB_KEY:"ACTIVE_SUB_TAB",CB_TESTCASE_LOADED_RESULT_MAP_KEY:"CB_TESTCASE_LOADED_RESULT_MAP_KEY",SETTINGS_KEY:"SETTINGS_KEY",USER_KEY:"USER_KEY",USER_CONFIG_KEY:"USER_CONFIG_KEY",TRANSPORT_CONFIG_KEY:"TRANSPORT_CONFIG_KEY",APP_STATE_TOKEN:"APP_STATE_TOKEN",TRANSPORT_DISABLED:"TRANSPORT_DISABLED",TRANSPORT_PROTOCOL:"TRANSPORT_PROTOCOL",remove:function(a){return b.remove(a)},removeList:function(a,c,d){return b.remove(a,c,d)},clearAll:function(){return b.clearAll()},set:function(a,c){return b.set(a,c)},get:function(a){return b.get(a)},getTransportConfig:function(a,c){return b.get(a+"-"+c+"-transport-configs")},setTransportConfig:function(a,c,d){return b.set(a+"-"+c+"-transport-configs",d)}};return c}]),angular.module("cf").factory("CF",["$rootScope","$http","$q","Message","Tree",function(a,b,c,d,e){var f={editor:null,cursor:null,tree:new e,testCase:null,selectedTestCase:null,message:new d,searchTableId:0};return f}]),angular.module("cf").factory("CFTestCaseListLoader",["$q","$http","StorageService","$timeout",function(a,b,c,d){return function(){var c=a.defer();return b.get("api/cf/testcases",{timeout:18e4}).then(function(a){c.resolve(angular.fromJson(a.data))},function(a){c.reject(a.data)}),c.promise}}]),angular.module("main").controller("MainService",["$scope",function(a){}]),angular.module("main").factory("TestingSettings",["$rootScope",function(a){var b={activeTab:0,getActiveTab:function(){return b.activeTab},setActiveTab:function(a){b.activeTab=a,b.save()},save:function(){sessionStorage.TestingActiveTab=b.activeTab},restore:function(){b.activeTab=null!=sessionStorage.TestingActiveTab&&""!=sessionStorage.TestingActiveTab?parseInt(sessionStorage.TestingActiveTab):0}};return b}]),angular.module("account").factory("Account",["$resource",function(a){return a("api/accounts/:id",{id:"@id"})}]),angular.module("account").factory("LoginService",["$resource","$q",function(a,b){return function(){var c=a("api/accounts/login"),d=b.defer();return c.get({},function(a){d.resolve(a)}),d.promise}}]),angular.module("account").factory("AccountLoader",["Account","$q",function(a,b){return function(c){var d=b.defer();return a.get({id:c},function(a){d.resolve(a)},function(){d.reject("Unable to fetch account")}),d.promise}}]),angular.module("account").factory("Testers",["$resource",function(a){return a("api/shortaccounts",{filter:"accountType::tester"})}]),angular.module("account").factory("Supervisors",["$resource",function(a){return a("api/shortaccounts",{filter:"accountType::supervisor"})}]),angular.module("account").factory("MultiTestersLoader",["Testers","$q",function(a,b){return function(){var c=b.defer();return a.query(function(a){c.resolve(a)},function(){c.reject("Unable to fetch list of testers")}),c.promise}}]),angular.module("account").factory("MultiSupervisorsLoader",["Supervisors","$q",function(a,b){return function(){var c=b.defer();return a.query(function(a){c.resolve(a)},function(){c.reject("Unable to fetch list of supervisors")}),c.promise}}]),angular.module("account").factory("userLoaderService",["userInfo","$q",function(a,b){var c=function(){var c=b.defer();return a.get({},function(a){c.resolve(a)},function(){c.reject("Unable to fetch user info")}),c.promise};return{load:c}}]),angular.module("account").factory("userInfo",["$resource",function(a){return a("api/accounts/cuser")}]),angular.module("account").factory("userLoaderService",["userInfo","$q",function(a,b){var c=function(){var c=b.defer();return a.get({},function(a){c.resolve(a)},function(){c.reject("Unable to fetch user info")}),c.promise};return{load:c}}]),angular.module("account").factory("userInfoService",["StorageService","userLoaderService","User","Transport","$q","$timeout",function(a,b,c,d,e,f){var g=null,h=!1,i=!1,j=!1,k=null,l="",m="",n=function(){k=a.get("userID"),l=a.get("username"),i=a.get("tester"),h=a.get("supervisor"),j=a.get("admin")},o=function(b){a.set("hthd",b)},p=function(b){return a.get("hthd")},q=function(){return""===a.get("username")?!1:!0},r=function(){return w()?g.accountId.toString():"0"},s=function(){return j},t=function(){return i},u=function(){return h},v=function(){return w()&&null!=g?g.pending:!1},w=function(){var a=void 0!==g&&null!=g&&g.authenticated===!0;return a},x=function(){if(w()){var a=e.defer();return f(function(){a.resolve(g)}),a.promise}return b.load()},y=function(){return g},z=function(a){g=a,null!==g&&void 0!==g?(l=g.username,k=g.accountId,m=g.fullName,angular.isArray(g.authorities)&&angular.forEach(g.authorities,function(a,b){switch(a.authority){case"user":break;case"admin":j=!0;break;case"tester":i=!0;break;case"supervisor":h=!0}})):(h=!1,i=!1,j=!1,l="",k=null,m="")},A=function(){return l},B=function(){return m};return{saveHthd:o,getHthd:p,hasCookieInfo:q,loadFromCookie:n,getAccountID:r,isAdmin:s,isTester:t,isAuthenticated:w,isPending:v,isSupervisor:u,setCurrentUser:z,getCurrentUser:y,loadFromServer:x,getUsername:A,getFullName:B}}]),angular.module("upload").factory("uploadService",["$rootScope","$http","$q","Message","Tree",function(a,b,c,d,e){}]),angular.module("main").controller("MainCtrl",["$scope","$rootScope","i18n","$location","userInfoService","$modal","$filter","base64","$http","Idle","Notification","IdleService","StorageService","TestingSettings","Session","AppInfo","User","$templateCache","$window","$sce",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){function u(){b.warning&&(b.warning.close(),b.warning=null),b.timedout&&(b.timedout.close(),b.timedout=null)}b.loginDialog=null,b.started=!1,a.language=function(){return c.language},a.setLanguage=function(a){c.setLanguage(a)},a.activeWhen=function(a){return a?"active":""},a.activeIfInList=function(a,b){var c=!1;if(angular.isArray(b)===!1)return"";for(var d=0;d<b.length&&c===!1;){if(b[d]===a)return"active";d++}return""},a.path=function(){return d.url()},a.login=function(){a.$emit("event:loginRequest",a.username,a.password)},a.loginReq=function(){b.loginMessage()&&(b.loginMessage().text="",b.loginMessage().show=!1),a.$emit("event:loginRequired")},a.logout=function(){a.execLogout()},a.execLogout=function(){e.setCurrentUser(null),a.username=a.password=null,a.$emit("event:logoutRequest"),d.url("/home")},a.cancel=function(){a.$emit("event:loginCancel")},a.isAuthenticated=function(){return e.isAuthenticated()},a.isPending=function(){return e.isPending()},a.isSupervisor=function(){return e.isSupervisor()},a.isTester=function(){return e.isTester()},a.isAdmin=function(){return e.isAdmin()},a.getRoleAsString=function(){return a.isTester()===!0?"tester":a.isSupervisor()===!0?"Supervisor":a.isAdmin()===!0?"Admin":"undefined"},a.getUsername=function(){return e.isAuthenticated()===!0?e.getUsername():""},b.showLoginDialog=function(c,d){b.loginDialog&&null!=b.loginDialog&&b.loginDialog.opened&&b.loginDialog.dismiss("cancel"),b.loginDialog=f.open({backdrop:"static",keyboard:"false",controller:"LoginCtrl",size:"lg",templateUrl:"views/account/login.html",resolve:{user:function(){return{username:a.username,password:a.password}}}}),b.loginDialog.result.then(function(b){b?(a.username=b.username,a.password=b.password,a.login()):a.cancel()})},b.started=!1,j.watch(),b.$on("IdleStart",function(){u(),b.warning=f.open({templateUrl:"warning-dialog.html",windowClass:"modal-danger"})}),b.$on("IdleEnd",function(){u()}),b.$on("IdleTimeout",function(){u(),a.isAuthenticated()?(b.$emit("event:execLogout"),b.timedout=f.open({templateUrl:"timedout-dialog.html",windowClass:"modal-danger"})):(m.clearAll(),o["delete"]().then(function(a){b.timedout=f.open({templateUrl:"timedout-dialog.html",windowClass:"modal-danger",backdrop:!0,keyboard:"false",controller:"FailureCtrl",resolve:{error:function(){return""}}}),b.timedout.result.then(function(){b.clearTemplate(),b.reloadPage()},function(){b.clearTemplate(),b.reloadPage()})}))}),a.$on("Keepalive",function(){a.isAuthenticated()&&l.keepAlive()}),b.$on("Keepalive",function(){l.keepAlive()}),b.$on("event:execLogout",function(){a.execLogout()}),b.start=function(){u(),j.watch(),b.started=!0},b.stop=function(){u(),j.unwatch(),b.started=!1},a.checkForIE=function(){var a={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser",this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version",this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(a){for(var b=0;b<a.length;b++){var c=a[b].string,d=a[b].prop;if(this.versionSearchString=a[b].versionSearch||a[b].identity,c){if(-1!==c.indexOf(a[b].subString))return a[b].identity}else if(d)return a[b].identity}},searchVersion:function(a){var b=a.indexOf(this.versionSearchString);if(-1!==b)return parseFloat(a.substring(b+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};if(a.init(),"Explorer"===a.browser);},b.readonly=!1,a.scrollbarWidth=0,b.showError=function(a){var c=f.open({templateUrl:"ErrorDlgDetails.html",controller:"ErrorDetailsCtrl",resolve:{error:function(){return a}}});c.result.then(function(a){b.error=a},function(){})},b.openRichTextDlg=function(a,b,c,d){f.open({templateUrl:"RichTextCtrl.html",controller:"RichTextCtrl",windowClass:"app-modal-window",backdrop:!0,keyboard:!0,backdropClick:!1,resolve:{editorTarget:function(){return{key:b,obj:a,disabled:d,title:c}}}})},b.openInputTextDlg=function(a,b,c,d){f.open({templateUrl:"InputTextCtrl.html",controller:"InputTextCtrl",backdrop:!0,keyboard:!0,windowClass:"app-modal-window",backdropClick:!1,resolve:{editorTarget:function(){return{key:b,obj:a,disabled:d,title:c}}}})},b.showError=function(a){var c=f.open({templateUrl:"ErrorDlgDetails.html",controller:"ErrorDetailsCtrl",resolve:{error:function(){return a}}});c.result.then(function(a){b.error=a},function(){})},b.cutString=function(a){return a.length>20&&(a=a.substring(0,20)+"..."),a},b.toHTML=function(a){return t.trustAsHtml(a)},b.selectTestingType=function(a){b.tabs[0]=!1,b.tabs[1]=!1,b.tabs[2]=!1,b.tabs[3]=!1,b.tabs[4]=!1,b.tabs[5]=!1,b.activeTab=a,b.tabs[b.activeTab]=!0,n.setActiveTab(b.activeTab)},b.downloadArtifact=function(a){var b=document.createElement("form");b.action="api/artifact/download",b.method="POST",b.target="_target";var c=document.createElement("input");c.name="path",c.value=a,b.appendChild(c),b.style.display="none",document.body.appendChild(b),b.submit()},b.tabs=new Array,b.compile=function(a){return $compile(a)},b.$on("$locationChangeSuccess",function(){b.setActive(d.path())}),b.openValidationResultInfo=function(){f.open({templateUrl:"ValidationResultInfoCtrl.html",windowClass:"profile-modal",controller:"ValidationResultInfoCtrl"})},b.openVersionChangeDlg=function(){m.clearAll(),b.vcModalInstance&&null!==b.vcModalInstance&&b.vcModalInstance.opened||(b.vcModalInstance=f.open({templateUrl:"VersionChanged.html",size:"lg",backdrop:"static",keyboard:"false",controller:"FailureCtrl",resolve:{error:function(){return""}}}),b.vcModalInstance.result.then(function(){b.clearTemplate(),b.reloadPage()},function(){b.clearTemplate(),b.reloadPage()}))},b.openCriticalErrorDlg=function(a){m.clearAll(),b.errorModalInstance&&null!==b.errorModalInstance&&b.errorModalInstance.opened||(b.errorModalInstance=f.open({templateUrl:"CriticalError.html",size:"lg",backdrop:!0,keyboard:"true",controller:"FailureCtrl",resolve:{error:function(){return a}}}),b.errorModalInstance.result.then(function(){b.clearTemplate(),b.reloadPage()},function(){b.clearTemplate(),b.reloadPage()}))},b.openSessionExpiredDlg=function(){m.clearAll(),b.sessionExpiredModalInstance&&null!==b.sessionExpiredModalInstance&&b.sessionExpiredModalInstance.opened||(b.sessionExpiredModalInstance=f.open({templateUrl:"timedout-dialog.html",size:"lg",backdrop:!0,keyboard:"true",controller:"FailureCtrl",resolve:{error:function(){return""}}}),b.sessionExpiredModalInstance.result.then(function(){b.clearTemplate(),b.reloadPage()},function(){b.clearTemplate(),b.reloadPage()}))},b.clearTemplate=function(){r.removeAll()},b.openErrorDlg=function(){d.path("/error")},b.pettyPrintType=function(a){return"TestStep"===a?"Test Step":"TestCase"===a?"Test Case":a},b.reloadPage=function(){s.location.reload()},b.openInvalidReqDlg=function(){b.errorModalInstance&&null!==b.errorModalInstance&&b.errorModalInstance.opened||(b.errorModalInstance=f.open({templateUrl:"InvalidReqCtrl.html",size:"lg",backdrop:!0,keyboard:"false",controller:"FailureCtrl",resolve:{error:function(){return""}}}),b.errorModalInstance.result.then(function(){b.reloadPage()},function(){b.reloadPage()}))},b.openNotFoundDlg=function(){b.errorModalInstance&&null!==b.errorModalInstance&&b.errorModalInstance.opened||(b.errorModalInstance=f.open({templateUrl:"NotFoundCtrl.html",size:"lg",backdrop:!0,keyboard:"false",controller:"FailureCtrl",resolve:{error:function(){return""}}}),b.errorModalInstance.result.then(function(){b.reloadPage()},function(){b.reloadPage()}))},b.nav=function(a){d.path(a)},b.showSettings=function(){f.open({templateUrl:"SettingsCtrl.html",size:"lg",keyboard:"false",controller:"SettingsCtrl"})},a.init=function(){},a.getFullName=function(){return e.isAuthenticated()===!0?e.getFullName():""}}]),angular.module("main").controller("LoginCtrl",["$scope","$modalInstance","user",function(a,b,c){a.user=c,a.cancel=function(){b.dismiss("cancel")},a.login=function(){b.close(a.user)}}]),angular.module("main").controller("RichTextCtrl",["$scope","$modalInstance","editorTarget",function(a,b,c){a.editorTarget=c,a.cancel=function(){b.dismiss("cancel")},a.close=function(){b.close(a.editorTarget)}}]),angular.module("main").controller("InputTextCtrl",["$scope","$modalInstance","editorTarget",function(a,b,c){a.editorTarget=c,a.cancel=function(){b.dismiss("cancel")},a.close=function(){b.close(a.editorTarget)}}]),angular.module("main").controller("ConfirmLogoutCtrl",["$scope","$modalInstance","$rootScope","$http",function(a,b,c,d){a.logout=function(){b.close()},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("main").controller("MessageWithHexadecimalDlgCtrl",["$scope","$modalInstance","original","MessageUtil",function(a,b,c,d){a.showHex=!0;var e=d.toHexadecimal(c);a.message=e,a.toggleHexadecimal=function(){a.showHex=!a.showHex,a.message=a.showHex?e:c},a.close=function(){b.dismiss("cancel")}}]),angular.module("main").controller("ValidationResultDetailsCtrl",["$scope","$modalInstance","selectedElement",function(a,b,c){a.selectedElement=c,a.ok=function(){b.close(a.selectedElement)},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("cf").controller("CFTestingCtrl",["$scope","$http","CF","$window","$modal","$filter","$rootScope","CFTestCaseListLoader","$timeout","StorageService","TestCaseService","TestStepService",function(a,b,c,d,e,f,g,h,i,j,k,l){a.cf=c,a.loading=!1,a.loadingTC=!1,a.error=null,a.testCases=[],a.testCase=null,a.tree={},a.tabs=new Array,a.error=null,a.collapsed=!1;var m=new k;a.setActiveTab=function(b){a.tabs[0]=!1,a.tabs[1]=!1,a.tabs[2]=!1,a.tabs[3]=!1,a.activeTab=b,a.tabs[a.activeTab]=!0},a.getTestCaseDisplayName=function(a){return a.parentName+" - "+a.label},a.selectTestCase=function(b){a.loadingTC=!0,i(function(){var d=j.get(j.CF_LOADED_TESTCASE_ID_KEY);if(null!=d&&l.clearRecords(d),b.testContext&&null!=b.testContext){c.testCase=b,a.testCase=c.testCase;var e=j.get(j.CF_LOADED_TESTCASE_ID_KEY);e!=b.id&&(j.set(j.CF_LOADED_TESTCASE_ID_KEY,b.id),j.remove(j.CF_EDITOR_CONTENT_KEY)),a.$broadcast("cf:testCaseLoaded",a.testCase),a.$broadcast("cf:profileLoaded",a.testCase.testContext.profile),a.$broadcast("cf:valueSetLibraryLoaded",a.testCase.testContext.vocabularyLibrary)}a.loadingTC=!1})},a.refreshTree=function(){i(function(){if(null!=a.testCases)if("function"==typeof a.tree.build_all){a.tree.build_all(a.testCases);var b=null,c=j.get(j.CF_LOADED_TESTCASE_ID_KEY);if(null!=c)for(var d=0;d<a.testCases.length;d++){var e=m.findOneById(c,a.testCases[d]);if(null!=e){b=e;break}}null!=b&&a.selectNode(b.id,b.type),a.expandAll(),a.error=null}else a.error="Ooops, Something went wrong. Please refresh your page again.";a.loading=!1},1e3)},a.initTesting=function(){j.remove(j.ACTIVE_SUB_TAB_KEY),a.error=null,a.testCases=[],a.loading=!0;var b=new h;b.then(function(b){angular.forEach(b,function(a){m.buildCFTestCases(a)}),a.testCases=f("orderBy")(b,"position"),a.refreshTree()},function(b){a.error="Sorry, Cannot load the profiles. Try again",a.loading=!1}),a.$on("$destroy",function(){var a=j.get(j.CF_LOADED_TESTCASE_ID_KEY);null!=a&&l.clearRecords(a)})},a.selectNode=function(b,c){i(function(){m.selectNodeByIdAndType(a.tree,b,c)},0)},a.openProfileInfo=function(){e.open({templateUrl:"CFProfileInfoCtrl.html",windowClass:"profile-modal",controller:"CFProfileInfoCtrl"})},a.isSelectable=function(a){return a.testContext&&null!=a.testContext},a.expandAll=function(){null!=a.tree&&a.tree.expand_all()},a.collapseAll=function(){null!=a.tree&&a.tree.collapse_all()}}]),angular.module("cf").controller("CFProfileInfoCtrl",["$scope","$modalInstance",function(a,b){a.close=function(){b.dismiss("cancel")}}]),angular.module("cf").controller("CFValidatorCtrl",["$scope","$http","CF","$window","$timeout","$modal","NewValidationResult","$rootScope","ServiceDelegator","StorageService","TestStepService","MessageUtil",function(a,b,c,d,e,f,g,h,i,j,k,l){a.cf=c,a.testCase=c.testCase,a.message=c.message,a.selectedMessage={},a.loading=!0,a.error=null,a.vError=null,a.vLoading=!0,a.mError=null,a.mLoading=!0,a.delimeters=[],a.counter=0,a.type="cf",a.loadRate=4e3,a.tokenPromise=null,a.editorInit=!1,a.nodelay=!1,a.resized=!1,a.selectedItem=null,a.activeTab=0,a.tError=null,a.tLoading=!1,a.hasNonPrintable=!1,a.dqaCodes=null!=j.get(j.DQA_OPTIONS_KEY)?angular.fromJson(j.get(j.DQA_OPTIONS_KEY)):[],a.showDQAOptions=function(){var b=f.open({templateUrl:"DQAConfig.html",controller:"DQAConfigCtrl",windowClass:"dq-modal",animation:!0,keyboard:!1,backdrop:!1});b.result.then(function(b){a.dqaCodes=b},function(){})},a.hasContent=function(){return""!=a.cf.message.content&&null!=a.cf.message.content},a.refreshEditor=function(){e(function(){a.editor&&a.editor.refresh()},1e3)},a.options={paramName:"file",formAcceptCharset:"utf-8",autoUpload:!0,type:"POST"},a.$on("fileuploadadd",function(b,c){(c.autoUpload||c.autoUpload!==!1&&$(this).fileupload("option","autoUpload"))&&c.process().done(function(){var b=c.files[0].name;c.url="api/message/upload";c.submit().success(function(c,d,e){a.nodelay=!0;var f=angular.fromJson(c);a.cf.message.name=b,a.cf.editor.instance.doc.setValue(f.content),
a.mError=null,a.execute()}).error(function(c,d,e){a.cf.message.name=b,a.mError="Sorry, Cannot upload file: "+b+", Error: "+e}).complete(function(a,b,c){})})}),a.loadMessage=function(){a.cf.testCase.testContext.message&&null!=a.cf.testCase.testContext.message&&(a.nodelay=!0,a.selectedMessage=a.cf.testCase.testContext.message,null!=a.selectedMessage&&null!=a.selectedMessage.content?a.editor.doc.setValue(a.selectedMessage.content):(a.editor.doc.setValue(""),a.cf.message.id=null,a.cf.message.name=""),a.execute())},a.setLoadRate=function(b){a.loadRate=b},a.initCodemirror=function(){a.editor=CodeMirror.fromTextArea(document.getElementById("cfTextArea"),{lineNumbers:!0,fixedGutter:!0,theme:"elegant",readOnly:!1,showCursorWhenSelecting:!0,gutters:["CodeMirror-linenumbers","cm-edi-segment-name"]}),a.editor.setSize("100%",345),a.editor.on("keyup",function(){e(function(){var b=a.editor.doc.getValue();a.error=null,a.tokenPromise&&(e.cancel(a.tokenPromise),a.tokenPromise=void 0),c.message.name=null,""!==b.trim()?a.tokenPromise=e(function(){a.execute()},a.loadRate):a.execute()})}),a.editor.on("dblclick",function(b){e(function(){var b=i.getCursorService(a.testCase.testContext.format).getCoordinate(a.editor,a.cf.tree);b.lineNumber=b.line,b.startIndex=b.startIndex+1,b.endIndex=b.endIndex+1,a.cf.cursor.init(b,!0),i.getTreeService(a.testCase.testContext.format).selectNodeByIndex(a.cf.tree.root,c.cursor,c.message.content)})})},a.validateMessage=function(){try{if(a.vLoading=!0,a.vError=null,null!=a.cf.testCase&&""!==a.cf.message.content){var b=a.cf.testCase.testContext.id,c=a.cf.message.content,d=(a.cf.testCase.label,i.getMessageValidator(a.testCase.testContext.format).validate(b,c,null,"Free",a.cf.testCase.testContext.dqa===!0?a.dqaCodes:[],"1223"));d.then(function(b){a.vLoading=!1,a.loadValidationResult(b)},function(b){a.vLoading=!1,a.vError=b,a.loadValidationResult(null)})}else a.loadValidationResult(null),a.vLoading=!1,a.vError=null}catch(e){a.vLoading=!1,a.vError=e,a.loadValidationResult(null)}},a.loadValidationResult=function(b){e(function(){h.$emit("cf:validationResultLoaded",b,a.cf.testCase)})},a.select=function(b){if(void 0!=b&&null!=b.path&&-1!=b.line){var c=i.getTreeService(a.testCase.testContext.format).selectNodeByPath(a.cf.tree.root,b.line,b.path),d=null!=c?c.data:null;a.cf.cursor.init(null!=d?d.lineNumber:b.line,null!=d?d.startIndex-1:b.column-1,null!=d?d.endIndex-1:b.column-1,null!=d?d.startIndex-1:b.column-1,!1),i.getEditorService(a.testCase.testContext.format).select(a.editor,a.cf.cursor)}},a.clearMessage=function(){a.nodelay=!0,a.mError=null,a.editor&&(a.editor.doc.setValue(""),a.execute())},a.saveMessage=function(){a.cf.message.download()},a.parseMessage=function(){try{if(null!=a.cf.testCase&&null!=a.cf.testCase.testContext&&""!=a.cf.message.content){a.tLoading=!0;var b=i.getMessageParser(a.testCase.testContext.format).parse(a.cf.testCase.testContext.id,a.cf.message.content);b.then(function(b){a.tLoading=!1,a.cf.tree.root.build_all(b.elements),i.updateEditorMode(a.editor,b.delimeters,a.cf.testCase.testContext.format),i.getEditorService(a.testCase.testContext.format).setEditor(a.editor),i.getTreeService(a.testCase.testContext.format).setEditor(a.editor)},function(b){a.tLoading=!1,a.tError=b})}else"function"==typeof a.cf.tree.root.build_all&&a.cf.tree.root.build_all([]),a.tError=null,a.tLoading=!1}catch(c){a.tLoading=!1,a.tError=c}},a.onNodeSelect=function(b){i.getTreeService(a.testCase.testContext.format).getEndIndex(b,a.cf.message.content),a.cf.cursor.init(b.data,!1),i.getEditorService(a.testCase.testContext.format).select(a.editor,a.cf.cursor)},a.execute=function(){null!=a.cf.testCase&&(a.tokenPromise&&(e.cancel(a.tokenPromise),a.tokenPromise=void 0),a.error=null,a.tError=null,a.mError=null,a.vError=null,a.cf.message.content=a.editor.doc.getValue(),a.setHasNonPrintableCharacters(),j.set(j.CF_EDITOR_CONTENT_KEY,a.cf.message.content),a.validateMessage(),a.parseMessage(),a.refreshEditor())},a.removeDuplicates=function(){a.vLoading=!0,a.$broadcast("cf:removeDuplicates")},a.initValidation=function(){a.vLoading=!1,a.tLoading=!1,a.mLoading=!1,a.error=null,a.tError=null,a.mError=null,a.vError=null,a.initCodemirror(),a.refreshEditor(),a.$on("cf:testCaseLoaded",function(b,c){if(a.testCase=c,null!=a.testCase){var d=null==j.get(j.CF_EDITOR_CONTENT_KEY)?"":j.get(j.CF_EDITOR_CONTENT_KEY);a.nodelay=!0,a.mError=null,a.cf.editor=i.getEditor(a.testCase.testContext.format),a.cf.editor.instance=a.editor,a.cf.cursor=i.getCursor(a.testCase.testContext.format),k.clearRecords(a.testCase.id),a.editor&&(a.editor.doc.setValue(d),a.execute())}}),h.$on("cf:duplicatesRemoved",function(b,c){a.vLoading=!1})},a.expandAll=function(){null!=a.cf.tree.root&&a.cf.tree.root.expand_all()},a.collapseAll=function(){null!=a.cf.tree.root&&a.cf.tree.root.collapse_all()},a.setHasNonPrintableCharacters=function(){a.hasNonPrintable=l.hasNonPrintable(a.cf.message.content)},a.showMessageWithHexadecimal=function(){f.open({templateUrl:"MessageWithHexadecimal.html",controller:"MessageWithHexadecimalDlgCtrl",windowClass:"valueset-modal",animation:!1,keyboard:!0,backdrop:!0,resolve:{original:function(){return a.cf.message.content}}})}}]),angular.module("cf").controller("CFReportCtrl",["$scope","$sce","$http","CF",function(a,b,c,d){a.cf=d}]),angular.module("cf").controller("CFVocabularyCtrl",["$scope","CF",function(a,b){a.cf=b}]),angular.module("cf").controller("CFProfileViewerCtrl",["$scope","CF","$rootScope",function(a,b,c){a.cf=b}]),angular.module("account").controller("UserProfileCtrl",["$scope","$resource","AccountLoader","Account","userInfoService","$location","Transport","Notification",function(a,b,c,d,e,f,g,h){var i=b("api/accounts/:id/passwordchange",{id:"@id"});a.accountpwd={},a.initModel=function(b){a.account=b,a.accountOrig=angular.copy(a.account)},a.updateAccount=function(){new d(a.account).$save().then(function(){g.init()},function(b){h.error({message:b.data,templateUrl:"NotificationErrorTemplate.html",scope:a,delay:5e4})}),a.accountOrig=angular.copy(a.account)},a.resetForm=function(){a.account=angular.copy(a.accountOrig)},a.isUnchanged=function(b){return angular.equals(b,a.accountOrig)},a.changePassword=function(){var b=new i;b.username=a.account.username,b.password=a.accountpwd.currentPassword,b.newPassword=a.accountpwd.newPassword,b.id=a.account.id,b.$save().then(function(b){a.msg=angular.fromJson(b)},function(b){h.error({message:b.data,templateUrl:"NotificationErrorTemplate.html",scope:a,delay:5e4})})},a.deleteAccount=function(){var b=new d;b.id=a.account.id,b.$remove(function(){e.setCurrentUser(null),a.$emit("event:logoutRequest"),f.url("/home")},function(b){h.error({message:b.data,templateUrl:"NotificationErrorTemplate.html",scope:a,delay:5e4})})},c(e.getAccountID()).then(function(b){a.initModel(b),a.$$phase||a.$apply()},function(b){h.error({message:b.data,templateUrl:"NotificationErrorTemplate.html",scope:a,delay:5e4})})}]),angular.module("account").controller("UserAccountCtrl",["$scope","$resource","AccountLoader","Account","userInfoService","$location","$rootScope",function(a,b,c,d,e,f,g){a.accordi={account:!0,accounts:!1},a.setSubActive=function(a){a&&null!=a&&(g.setSubActive(a),$(".accountMgt").hide(),$("#"+a).show())},a.initAccount=function(){null==g.subActivePath&&(g.subActivePath="account"),a.setSubActive(g.subActivePath)}}]),angular.module("account").controller("AccountsListCtrl",["$scope","MultiAuthorsLoader","MultiSupervisorsLoader","Account","$modal","$resource","AccountLoader","userInfoService","$location","Notification",function(a,b,c,d,e,f,g,h,i,j){a.tmpAccountList=[].concat(a.accountList),a.account=null,a.accountOrig=null,a.accountType="tester",a.scrollbarWidth=a.getScrollbarWidth();var k=f("api/accounts/:id/userpasswordchange",{id:"@id"}),l=f("api/accounts/:id/approveaccount",{id:"@id"}),m=f("api/accounts/:id/suspendaccount",{id:"@id"});a.msg=null,a.accountpwd={},a.updateAccount=function(){new d(a.account).$save(function(a){},function(b){j.error({message:b.data,templateUrl:"NotificationErrorTemplate.html",scope:a,delay:5e4})}),a.accountOrig=angular.copy(a.account)},a.resetForm=function(){a.account=angular.copy(a.accountOrig)},a.isUnchanged=function(b){return angular.equals(b,a.accountOrig)},a.changePassword=function(){var b=new k;b.username=a.account.username,b.password=a.accountpwd.currentPassword,b.newPassword=a.accountpwd.newPassword,b.id=a.account.id,b.$save().then(function(b){a.msg=angular.fromJson(b)},function(b){j.error({message:b.data,templateUrl:"NotificationErrorTemplate.html",scope:a,delay:5e4})})},a.loadAccounts=function(){h.isAuthenticated()&&h.isAdmin()&&(a.msg=null,(new b).then(function(b){a.accountList=b,a.tmpAccountList=[].concat(a.accountList)},function(b){j.error({message:b.data,templateUrl:"NotificationErrorTemplate.html",scope:a,delay:5e4})}))},a.initManageAccounts=function(){a.loadAccounts()},a.selectAccount=function(b){a.accountpwd={},a.account=b,a.accountOrig=angular.copy(a.account)},a.deleteAccount=function(){a.confirmDelete(a.account)},a.confirmDelete=function(b){var c=e.open({templateUrl:"ConfirmAccountDeleteCtrl.html",controller:"ConfirmAccountDeleteCtrl",resolve:{accountToDelete:function(){return b},accountList:function(){return a.accountList}}});c.result.then(function(b,c){a.accountToDelete=b,a.accountList=c},function(b){j.error({message:b.data,templateUrl:"NotificationErrorTemplate.html",scope:a,delay:5e4})})},a.approveAccount=function(){var b=new l;b.username=a.account.username,b.id=a.account.id,b.$save().then(function(b){a.account.pending=!1,a.msg=angular.fromJson(b)},function(b){j.error({message:b.data,templateUrl:"NotificationErrorTemplate.html",scope:a,delay:5e4})})},a.suspendAccount=function(){var b=new m;b.username=a.account.username,b.id=a.account.id,b.$save().then(function(b){a.account.pending=!0,a.msg=angular.fromJson(b)},function(b){j.error({message:b.data,templateUrl:"NotificationErrorTemplate.html",scope:a,delay:5e4})})}}]),angular.module("account").controller("ConfirmAccountDeleteCtrl",["$scope","$modalInstance","accountToDelete","accountList","Account","Notification",function(a,b,c,d,e,f){a.accountToDelete=c,a.accountList=d,a["delete"]=function(){e.remove({id:c.id},function(){var d=a.accountList.indexOf(c);-1!==index&&a.accountList.splice(d,1),b.close(a.accountToDelete)},function(b){f.error({message:b.data,templateUrl:"NotificationErrorTemplate.html",scope:a,delay:5e4})})},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("account").controller("ForgottenCtrl",["$scope","$resource","$rootScope","Notification",function(a,b,c,d){var e=b("api/sooa/accounts/passwordreset",{username:"@username"});a.requestResetPassword=function(){var b=new e;b.username=a.username,b.$save(function(){"resetRequestProcessed"===b.text&&(a.username="")},function(b){d.error({message:b.data,templateUrl:"NotificationErrorTemplate.html",scope:a,delay:5e4})})},a.getAppInfo=function(){return c.appInfo}}]),angular.module("account").controller("RegistrationCtrl",["$scope","$resource","$modal","$location","$rootScope",function(a,b,c,d,e){a.account={},a.registered=!1,a.agreed=!1;var f=(b("api/sooa/usernames/:username",{username:"@username"}),b("api/sooa/emails/:email",{email:"@email"}),b("api/sooa/accounts/register"));a.registerAccount=function(){if(a.agreed){var b=new f;b.accountType="tester",b.employer=a.account.employer,b.fullName=a.account.fullName,b.phone=a.account.phone,b.title=a.account.title,b.juridiction=a.account.juridiction,b.username=a.account.username,b.password=a.account.password,b.email=a.account.email,b.signedConfidentialityAgreement=!0,b.$save(function(){"userAdded"===b.text?(a.account={},a.registered=!0,d.path("/registrationSubmitted")):a.registered=!1},function(){a.registered=!1}),a.registered=!0}},a.getAppInfo=function(){return e.appInfo}}]),angular.module("account").controller("RegisterResetPasswordCtrl",["$scope","$resource","$modal","$routeParams","isFirstSetup","Notification",function(a,b,c,d,e,f){a.agreed=!1,a.displayForm=!0,a.isFirstSetup=e,angular.isDefined(d.username)||(a.displayForm=!1),""===d.username&&(a.displayForm=!1),angular.isDefined(d.token)||(a.displayForm=!1),""===d.token&&(a.displayForm=!1),angular.isDefined(d.userId)||(a.displayForm=!1),""===d.userId&&(a.displayForm=!1);var g=(b("api/sooa/accounts/register/:userId/passwordreset",{userId:"@userId",token:"@token"}),b("api/sooa/accounts/:id/passwordreset",{id:"@userId",token:"@token"}));a.user={},a.user.username=d.username,a.user.newUsername=d.username,a.user.userId=d.userId,a.user.token=d.token,a.changePassword=function(){if(a.agreed){var b=new g(a.user);b.$save(function(){a.user.password="",a.user.passwordConfirm=""},function(b){f.error({message:b.data,templateUrl:"NotificationErrorTemplate.html",scope:a,delay:5e4})})}}}]),angular.module("hit-tool-directives").directive("compile",["$compile",function(a){return function(b,c,d){b.$watch(function(a){return a.$eval(d.compile)},function(d){c.html(d),a(c.contents())(b)})}}]),angular.module("hit-tool-directives").directive("stRatio",function(){return{link:function(a,b,c){var d=+c.stRatio;b.css("width",d+"%")}}}),angular.module("hit-tool-directives").directive("csSelect",function(){return{require:"^stTable",template:"",scope:{row:"=csSelect"},link:function(a,b,c,d){b.bind("change",function(b){a.$apply(function(){d.select(a.row,"single")})}),a.$watch("row.isSelected",function(a,c){a===!0?b.parent().addClass("st-selected"):b.parent().removeClass("st-selected")})}}}),angular.module("hit-tool-directives").directive("mypopover",["$compile","$templateCache",function(a,b){return{restrict:"A",link:function(a,c,d){var e=b.get("profileInfo.html"),f={content:e,placement:"bottom",html:!0};$(c).popover(f)}}}]),angular.module("hit-tool-directives").directive("windowExit",["$window","$templateCache","$http","User",function(a,b,c,d){return{restrict:"AE",compile:function(c,d){var e=a.attachEvent||a.addEventListener,f=a.attachEvent?"onbeforeunload":"beforeunload";e(f,function(a){b.removeAll()})}}}]),angular.module("hit-tool-directives").directive("msg",[function(){return{restrict:"EA",replace:!0,link:function(a,b,c){var d=c.key;c.keyExpr&&a.$watch(c.keyExpr,function(a){d=a,b.text($.i18n.prop(a))}),a.$watch("language()",function(a){b.text($.i18n.prop(d))})}}}]),angular.module("account").directive("checkEmail",["$resource",function(a){return{restrict:"AC",require:"ngModel",link:function(b,c,d,e){var f=a("api/sooa/emails/:email",{email:"@email"}),g=/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/;c.on("keyup",function(){if(0!==c.val().length&&g.test(c.val())){var a=new f({email:c.val()});a.$get(function(){b.emailUnique="emailNotFound"===a.text?"valid":void 0,b.emailValid=g.test(c.val())?"valid":void 0,b.emailUnique&&b.emailValid?e.$setValidity("email",!0):e.$setValidity("email",!1)},function(){})}else b.emailUnique=void 0,b.emailValid=void 0,e.$setValidity("email",!1)})}}}]),angular.module("account").directive("checkEmployer",[function(){return{require:"ngModel",link:function(a,b,c,d){var e="#"+c.checkEmployer;b.add(e).on("keyup",function(){a.$apply(function(){var a=b.val()===$(firstPassword).val();d.$setValidity("noMatch",a)})})}}}]),angular.module("account").directive("checkPassword",[function(){return{require:"ngModel",link:function(a,b,c,d){var e="#"+c.checkPassword;b.add(e).on("keyup",function(){a.$apply(function(){var a=b.val()===$(e).val();d.$setValidity("noMatch",a)})})}}}]),angular.module("account").directive("checkPhone",[function(){return{restrict:"AC",require:"ngModel",link:function(a,b,c,d){var e=/[0-9]*/;b.on("keyup",function(){b.val()&&null!=b.val()&&""!=b.val()?(a.phoneIsNumber=e.test(b.val())&&b.val()>0?"valid":void 0,a.phoneValidLength=b.val().length>=7?"valid":void 0,a.phoneIsNumber&&a.phoneValidLength?d.$setValidity("phone",!0):d.$setValidity("phone",!1)):(a.phoneIsNumber=void 0,a.phoneValidLength=void 0,d.$setValidity("phone",!0))})}}}]),angular.module("account").directive("checkPoaDate",[function(){return{replace:!0,link:function(a,b,c,d){var e=b.find("#inputStartDate"),f=b.find("#inputEndDate"),g=e.inheritedData().$ngModelController,h=f.inheritedData().$ngModelController,i=function(){var a=new Date(e.val()),b=new Date(f.val());b>a?(g.$setValidity("datesOK",!0),h.$setValidity("datesOK",!0)):(g.$setValidity("datesOK",!1),h.$setValidity("datesOK",!1))};e.on("change",i),f.on("change",i)}}}]),angular.module("account").directive("checkTimerange",[function(){return{replace:!0,link:function(a,b,c,d){var e,f,g,h,i=b.children(),j=i.find(".shour"),k=i.find(".sminute"),l=i.find(".ehour"),m=i.find(".eminute");e=j.inheritedData().$ngModelController,f=k.inheritedData().$ngModelController,g=l.inheritedData().$ngModelController,h=m.inheritedData().$ngModelController;var n=!0,o=function(){n&&(e.$setViewValue(e.$modelValue),f.$setViewValue(f.$modelValue),g.$setViewValue(g.$modelValue),h.$setViewValue(h.$modelValue),n=!1);var a=new Date,b=angular.copy(a),c=angular.copy(a);b.setHours(j.val()),b.setMinutes(k.val()),c.setHours(l.val()),c.setMinutes(m.val()),c>b?(e.$setValidity("poaOK",!0),f.$setValidity("poaOK",!0),g.$setValidity("poaOK",!0),h.$setValidity("poaOK",!0)):(e.$setValidity("poaOK",!1),f.$setValidity("poaOK",!1),g.$setValidity("poaOK",!1),h.$setValidity("poaOK",!1))};j.on("change",o),k.on("change",o),l.on("change",o),m.on("change",o)}}}]),angular.module("account").directive("checkUsername",["$resource",function(a){return{restrict:"AC",require:"ngModel",link:function(b,c,d,e){var f=a("api/sooa/usernames/:username",{username:"@username"});c.on("keyup",function(){if(c.val().length>=4){var a=new f({username:c.val()});a.$get(function(){b.usernameValidLength=c.val()&&c.val().length>=4&&c.val().length<=20?"valid":void 0,b.usernameUnique="usernameNotFound"===a.text?"valid":void 0,b.usernameValidLength&&b.usernameUnique?e.$setValidity("username",!0):e.$setValidity("username",!1)},function(){})}else b.usernameValidLength=void 0,b.usernameUnique=void 0,e.$setValidity("username",!1)})}}}]),angular.module("account").directive("passwordValidate",[function(){return{require:"ngModel",link:function(a,b,c,d){d.$parsers.unshift(function(b){return a.pwdValidLength=b&&b.length>=7?"valid":void 0,a.pwdHasLowerCaseLetter=b&&/[a-z]/.test(b)?"valid":void 0,a.pwdHasUpperCaseLetter=b&&/[A-Z]/.test(b)?"valid":void 0,a.pwdHasNumber=b&&/\d/.test(b)?"valid":void 0,a.pwdValidLength&&a.pwdHasLowerCaseLetter&&a.pwdHasUpperCaseLetter&&a.pwdHasNumber?(d.$setValidity("pwd",!0),b):void d.$setValidity("pwd",!1)})}}}]),angular.module("upload").controller("UploadCtrl",["$scope","$http","$window","$modal","$filter","$rootScope","$timeout","StorageService","TestCaseService","TestStepService","FileUploader","Notification",function(a,b,c,d,e,f,g,h,i,j,k,l){a.profileCheckToggleStatus=!1;var m=a.profileUploader=new k({url:"api/gvtupload/uploadprofile"}),n=a.vsUploader=new k({url:"api/gvtupload/uploadvs"}),o=a.constraintsUploader=new k({url:"api/gvtupload/uploadcontraints"});m.onErrorItem=function(a,b,c,d){l.error({message:"There was an error while uploading "+a.file.name,templateUrl:"NotificationErrorTemplate.html",scope:f,delay:1e4})},m.onCompleteItem=function(b,c,d,e){a.profileMessages=c.profiles},a.getSelectedTestcases=function(){return _.where(a.profileMessages,{activated:!0})},a.profileCheckToggle=function(){a.profileMessages.forEach(function(b){b.activated=a.profileCheckToggleStatus})},a.upload=function(a){m.uploadAll(),n.uploadAll(),o.uploadAll()},a.remove=function(a){m.clearQueue(),n.clearQueue(),o.clearQueue()},a.addSelectedTestCases=function(){b.post("api/gvtupload/addtestcases",a.getSelectedTestcases()).then(function(a){l.success({message:"Test Cases saved !",templateUrl:"NotificationSuccessTemplate.html",scope:f,delay:5e3})},function(a){l.error({message:a.data,templateUrl:"NotificationErrorTemplate.html",scope:f,delay:1e4})})},a.clearTestCases=function(){b.post("api/gvtupload/cleartestcases").then(function(b){a.profileMessages.length=0,l.success({message:"Test Cases cleared !",templateUrl:"NotificationSuccessTemplate.html",scope:f,delay:5e3})},function(a){l.error({message:a.data,templateUrl:"NotificationErrorTemplate.html",scope:f,delay:1e4})})},a.getTotalProgress=function(){var a=0,b=0;return m.queue.length>0&&(a++,b+=m.progress),n.queue.length>0&&(a++,b+=n.progress),o.queue.length>0&&(a++,b+=o.progress),b/a}}]);